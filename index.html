<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>PINE FOREST | 11åŸºåœ°æ™ºæ…§é–‰ç’°çµ‚ç«¯ (é‚„åŸæ•¸æ“šç‰ˆ)</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --neon: #00f2ff; --forest: #39ff14; --bg: #000a15; --panel: rgba(0,25,50,0.98); --card: rgba(255,255,255,0.06); }
        body, html { margin: 0; padding: 0; background: var(--bg); color: #fff; font-family: 'Segoe UI', 'PingFang TC', sans-serif; overflow: hidden; }
        
        .grid { position: fixed; width: 100%; height: 100%; background: linear-gradient(rgba(0,242,255,0.05) 1px, transparent 1px) 0 0 / 40px 40px; z-index: -1; }
        .scanline { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, transparent 50%, rgba(0,242,255,0.02) 50%); background-size: 100% 4px; z-index: 1000; pointer-events: none; }

        .content-box { display: flex; width: 97%; height: 92vh; gap: 20px; margin: 4vh auto; }
        
        /* åœ°åœ–å€åŸŸï¼šé»‘åº•ç™½ç·šç§‘æŠ€é¢¨æ ¼ */
        .map-area { flex: 1.1; background: #000; border: 1.5px solid rgba(0,242,255,0.3); border-radius: 20px; position: relative; overflow: hidden; z-index: 1; }
        #map-engine { width: 100%; height: 100%; background: #000; }

        /* å½ˆçª— UIï¼šé‚„åŸæ‚¨åŸæœ¬çš„æ¨£å¼èˆ‡ä½ˆå±€ */
        #base-detail { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--panel); z-index: 1001; display: none; flex-direction: column; padding: 30px; box-sizing: border-box; border-radius: 20px; }
        .base-img { width: 100%; height: 250px; object-fit: cover; border-radius: 15px; border: 1px solid var(--neon); margin-bottom: 20px; }
        .base-iot-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .iot-stat { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; border-left: 3px solid var(--forest); }

        /* å³å´é¢æ¿ï¼š100% é‚„åŸ */
        .panel { flex: 1.6; background: var(--panel); border: 1px solid var(--neon); border-radius: 20px; display: flex; flex-direction: column; padding: 25px; overflow-y: auto; scrollbar-width: none; }
        .section-header { border-bottom: 1.5px solid var(--neon); padding-bottom: 10px; margin-bottom: 20px; }
        .tech-item { background: var(--card); border: 1px solid rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; margin-bottom: 10px; border-left: 4px solid var(--neon); }
        .tech-info h4 { margin: 0; font-size: 0.95rem; color: #fff; }
        .tech-info p { margin: 4px 0 0 0; font-size: 0.8rem; color: #aaa; }
        .kpi-row { display: flex; gap: 10px; margin: 10px 0 25px 0; }
        .kpi-box { flex: 1; background: rgba(0,242,255,0.08); border: 1px solid var(--neon); padding: 12px; text-align: center; border-radius: 10px; }
        .kpi-v { font-size: 1.4rem; color: var(--forest); font-weight: bold; display: block; }

        /* å¾ªç’°å‹•ç•«ï¼š100% é‚„åŸ */
        .cycle-area { border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; position: relative; }
        .pulse-container { display: flex; justify-content: space-between; position: relative; padding: 25px 0; height: 100px; }
        .p-node { width: 85px; text-align: center; z-index: 2; position: relative; }
        .p-icon { width: 50px; height: 50px; border: 1px solid var(--forest); background: #000; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 8px; font-size: 1.3rem; box-shadow: 0 0 10px rgba(57,255,20,0.2); }
        .p-node b { font-size: 0.75rem; color: var(--forest); display: block; }
        .p-node p { font-size: 0.65rem; color: #999; margin: 3px 0 0 0; line-height: 1.2; }
        .p-stream { position: absolute; width: 80px; height: 2px; background: linear-gradient(90deg, transparent, var(--forest), transparent); top: 50px; z-index: 1; animation: laser 3s infinite linear; }
        @keyframes laser { 0% { left: 10%; opacity: 0; } 50% { opacity: 1; } 100% { left: 85%; opacity: 0; } }

        /* åœ°åœ–æ¨™é»æ¨£å¼å„ªåŒ– */
        .leaflet-control-attribution, .leaflet-control-zoom { display: none !important; }
        .glow-dot { 
            width: 14px; height: 14px; background: var(--forest); border-radius: 50%; 
            border: 2px solid #fff; box-shadow: 0 0 15px var(--forest), 0 0 30px var(--forest); 
            cursor: pointer; 
        }
        .clean-label { 
            background: none !important; border: none !important;
            color: #fff !important; font-size: 13px !important; font-weight: 800 !important;
            text-shadow: 0 0 8px var(--neon), 2px 2px 3px #000;
            white-space: nowrap; pointer-events: none;
        }
    </style>
</head>
<body>

<div class="grid"></div>
<div class="scanline"></div>

<div class="content-box">
    <div class="map-area">
        <div id="map-engine"></div>
        <div id="base-detail">
            <h2 id="b-name" style="color:var(--neon); margin:0 0 20px 0;"></h2>
            <img id="b-img" class="base-img" src="">
            <div class="base-iot-grid" id="iot-container">
                <div class="iot-stat" style="grid-column: span 2;"><b>å¯¦æ™‚ç«™é»æº«åº¦</b><p id="b-temp" style="font-size:1.2rem; font-weight:bold; color:var(--forest);"></p></div>
                <div class="iot-stat" id="stat-plant"><b>ğŸŒ± ç¨®æ¤ IOT å¯¦æ™‚æ•¸æ“š</b><p id="b-plant" style="font-size:0.85rem; line-height:1.5; color:#aaa;"></p></div>
                <div class="iot-stat" id="stat-animal"><b>ğŸ„ é¤Šæ®– IOT å¯¦æ™‚æ•¸æ“š</b><p id="b-animal" style="font-size:0.85rem; line-height:1.5; color:#aaa;"></p></div>
            </div>
            <button onclick="hideBase()" style="margin-top:auto; padding:15px; background:var(--neon); border:none; border-radius:10px; font-weight:bold; cursor:pointer; color:#000;">CLOSE INTERFACE</button>
        </div>
    </div>

    <div class="panel">
        <div class="section-header"><h2 style="color:var(--neon); margin:0;">SECTION A / æ™ºæ…§ç”Ÿæ…‹æºé ­</h2></div>
        <div class="tech-item"><div class="tech-info"><h4>01. ç”Ÿç‰©ç§‘æŠ€ç ”ç™¼æ ¸å¿ƒ (R&D)</h4><p>å°ˆåˆ©å­æ°§èŒç¾¤èˆ‡ç”Ÿç‰©é˜²æ²»ï¼Œæ¸›å°‘ 95% åŒ–å­¸è—¥åŠ‘ä¾è³´ã€‚</p></div></div>
        <div class="tech-item"><div class="tech-info"><h4>02. AI & IoT æ™ºèƒ½ç›£æ¸¬ç³»çµ±</h4><p>5G å¤šå…‰è­œæ„ŸçŸ¥èˆ‡ AI è­˜åˆ¥ï¼Œé è­¦æº–ç¢ºç‡é” 98.2%ã€‚</p></div></div>
        <div class="tech-item"><div class="tech-info"><h4>03. å€å¡Šéˆå…¨ç¨‹æ•¸æ“šæº¯æº</h4><p>æ•¸å­—èº«ä»½è­‰è¨˜éŒ„ç¢³è¶³è·¡èˆ‡å“è³ªï¼Œå¯¦ç¾ 100% è¦†è“‹ã€‚</p></div></div>
        <div class="kpi-row">
            <div class="kpi-box"><span class="kpi-v">12,450t</span><span style="font-size:9px;">å¹´æ¸›ç¢³é‡</span></div>
            <div class="kpi-box"><span class="kpi-v">98.2%</span><span style="font-size:9px;">é è­¦æº–ç¢ºç‡</span></div>
            <div class="kpi-box"><span class="kpi-v">100%</span><span style="font-size:9px;">æº¯æºè¦†è“‹</span></div>
        </div>
        <div class="cycle-area">
            <div style="color:var(--forest); font-weight:bold; font-size:1rem; margin-bottom:10px;">â™»ï¸ è³‡æºæ·±åº¦é–‰ç’°èˆ‡å¾ªç’°è¾²æ¥­</div>
            <div class="pulse-container">
                <div class="p-line"></div><div class="p-stream"></div>
                <div class="p-node"><div class="p-icon">ğŸ’§</div><b>æ°´è³‡æºå¾ªç’°</b><p>æ·¨åŒ–å¾Œå›æµè¾²å ´çŒæº‰</p></div>
                <div class="p-node"><div class="p-icon">ğŸ’©</div><b>æœ‰æ©Ÿè‚¥å›çŒ</b><p>å»¢æ¸£è½‰åŒ–è‚¥æ–™æ”¹åœŸ</p></div>
                <div class="p-node"><div class="p-icon">ğŸ”¥</div><b>æº«å®¤ä¾›èƒ½</b><p>æ²¼æ°£è½‰åŒ–æ”¯æ’èƒ½æº</p></div>
                <div class="p-node"><div class="p-icon">ğŸŒ¾</div><b>é£¼æ–™å¾ªç’°</b><p>è¾²å‰¯ç”¢ç‰©è™•ç†å›æµ</p></div>
            </div>
        </div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // 1. åˆå§‹åŒ–åœ°åœ–
    const map = L.map('map-engine', { 
        center: [34.0, 108.5], 
        zoom: 4.8, 
        zoomControl: false, 
        attributionControl: false 
    });

    // 2. ç§‘æŠ€é»‘åº•ç™½ç·šåº•åœ–ç–ŠåŠ 
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}').addTo(map);
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}').addTo(map);

    // 3. æ•¸æ“šå®Œå…¨é‚„åŸ (å¾æ‚¨çš„åŸå§‹ index.html æå–)
    const bases = [
        { name: "ç”˜è‚…", lat: 38.47, lng: 104.57, temp: '21.4Â°C', 
          plant: 'å“ç¨®: è¥¿ç“œ/ç•ªèŒ„<br>é€²åº¦: ç¬¬ 82 å¤© (æœå¯¦è†¨å¤§æœŸ)<br>é€Ÿåº¦: 8.5mm/d<br>æ¾†æ°´: é è¨ˆ 18:00 (è‡ªå‹•æ»´çŒ)<br>åœŸå£¤æ¿•åº¦: 32%', 
          animal: 'å“ç¨®: ç¾Š/è‚‰ç‰›<br>é€²åº¦: ç¬¬ 145 å¤© (è‚²è‚¥æœŸ)<br>å¢é‡: 1.3kg/d<br>é¤µé£Ÿ: 17:30 (TMRæ··åˆç³§)<br>å¿ƒç‡ç›£æ¸¬: 72bpm', 
          img: 'https://images.unsplash.com/photo-1516253593875-bd7ba052fbc5?auto=format&fit=crop&w=800' },
        
        { name: "æ¹–åŒ—", lat: 30.59, lng: 114.30, temp: '26.8Â°C', 
          plant: 'å“ç¨®: æ°´è€•èœã€è‘‰èœé¡<br>é€²åº¦: ç¬¬ 18 å¤© (å¿«é€Ÿç”Ÿé•·æœŸ)<br>é€Ÿåº¦: 12mm/d<br>æ¾†æ°´: å¾ªç’°ä¾›æ°´ä¸­ (PH 6.2)<br>å…‰ç…§: 8500 Lux', animal: '', 
          img: 'https://images.unsplash.com/photo-1558449028-b53a39d100fc?auto=format&fit=crop&w=800' },

        { name: "è²´å·", lat: 26.58, lng: 106.71, temp: '19.5Â°C', 
          plant: 'å“ç¨®: è±†è‹—/è‘‰èœ<br>é€²åº¦: ç¬¬ 38 å¤© (æˆç†Ÿå‰æœŸ)<br>é€Ÿåº¦: 5.2mm/d<br>æ¾†æ°´: é è¨ˆ 19:00 (å®šæ™‚å™´æ·‹)', animal: '', 
          img: 'https://images.unsplash.com/photo-1523348837708-15d4a09cfac2?auto=format&fit=crop&w=800' },

        { name: "å»£æ±", lat: 23.13, lng: 113.26, temp: '30.2Â°C', 
          plant: 'å“ç¨®: èœå¿ƒ/ç±³<br>é€²åº¦: ç¬¬ 52 å¤© (æŠ½ç©—æœŸ)<br>é€Ÿåº¦: 10mm/d<br>æ¾†æ°´: 06:00 å·²å®Œæˆ (è‡ªå‹•æ»´çŒ)', 
          animal: 'å“ç¨®: è±¬<br>é€²åº¦: ç¬¬ 98 å¤© (è‚²æˆæœŸ)<br>å¢é‡: 0.85kg/d<br>é¤µé£Ÿ: 18:00 (è‡ªå‹•æŠ•æ”¾)<br>æ°¨æ°£æ¿ƒåº¦: 12ppm', 
          img: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?auto=format&fit=crop&w=800' },

        { name: "å±±æ±", lat: 36.67, lng: 117.00, temp: '24.5Â°C', 
          plant: 'å“ç¨®: ç“œæœã€é’ç“œã€ç•ªèŒ„<br>é€²åº¦: ç¬¬ 112 å¤© (ç››ç”¢æœŸ)<br>é€Ÿåº¦: ç©©å®šæˆé•·<br>æ¾†æ°´: æ™ºèƒ½èª¿ç¯€ä¸­ (æ¿•åº¦ 65%)', animal: '', 
          img: 'https://images.unsplash.com/photo-1585320806297-9794b3e4eeae?auto=format&fit=crop&w=800' },

        { name: "æ±Ÿè¥¿", lat: 28.68, lng: 115.89, temp: '27.5Â°C', 
          plant: 'å“ç¨®: æ°´æœç‰ç±³ã€å—ç“œä»”<br>é€²åº¦: ç¬¬ 62 å¤© (æˆç²‰å®ŒæˆæœŸ)<br>é€Ÿåº¦: 15mm/d<br>æ¾†æ°´: 07:00 å·²å®Œæˆ (å¾®å™´ç³»çµ±)', animal: '', 
          img: 'https://images.unsplash.com/photo-1530507629858-e4977d30e9e0?auto=format&fit=crop&w=800' },

        { name: "å…§è’™å¤", lat: 40.84, lng: 111.75, temp: '18.2Â°C', 
          plant: 'å“ç¨®: ç“œæœã€é’ç“œã€ç•ªèŒ„<br>é€²åº¦: ç¬¬ 88 å¤© (æ›æœç©©å®šå™¨)<br>é€Ÿåº¦: æ­£å¸¸<br>æ¾†æ°´: è‡ªå‹•æº«æ„Ÿè£œæ°´', animal: '', 
          img: 'https://images.unsplash.com/photo-1466692476868-aef1dfb1e735?auto=format&fit=crop&w=800' },

        { name: "å»£è¥¿", lat: 22.82, lng: 108.32, temp: '29.8Â°C', plant: '', 
          animal: 'å“ç¨®: è±¬<br>é€²åº¦: ç¬¬ 85 å¤© (è‚²è‚¥å‰æœŸ)<br>å¢é‡: 0.92kg/d<br>é¤µé£Ÿ: 08:30 å·²å®Œæˆ (å®šé‡ç³»çµ±)', 
          img: 'https://images.unsplash.com/photo-1516467508483-a7212febe31a?auto=format&fit=crop&w=800' },

        { name: "å‰æ—", lat: 43.84, lng: 126.55, temp: '12.0Â°C', plant: '', 
          animal: 'å“ç¨®: è‚‰ç‰›<br>é€²åº¦: ç¬¬ 240 å¤© (æˆé•·ä¸­æœŸ)<br>å¢é‡: 1.5kg/d<br>é¤µé£Ÿ: 06:00 å·²å®Œæˆ (å…¨æ··åˆæ—¥ç³§)', 
          img: 'https://images.unsplash.com/photo-1570042225831-d98fa7577f1e?auto=format&fit=crop&w=800' },

        { name: "é¼å¯§", lat: 41.80, lng: 123.43, temp: '15.5Â°C', plant: '', 
          animal: 'å“ç¨®: è‚‰ç‰›<br>é€²åº¦: ç¬¬ 310 å¤© (æˆç†ŸæœŸ)<br>å¢é‡: 1.1kg/d<br>é¤µé£Ÿ: 07:00 å·²å®Œæˆ (è‡ªå‹•é€æ–™ç³»çµ±)', 
          img: 'https://images.pexels.com/photos/422218/pexels-photo-422218.jpeg?auto=compress&cs=tinysrgb&w=800' },

        { name: "æ²³å—", lat: 34.75, lng: 113.66, temp: '25.8Â°C', 
          plant: 'å“ç¨®: å¤§å®—ç³§é£Ÿä½œç‰©<br>é€²åº¦: ç¬¬ 105 å¤© (çŒæ¼¿æˆç†ŸæœŸ)<br>é€Ÿåº¦: ç©©å®š (è¡›æ˜Ÿ NDVI ç›£æ¸¬å„ª)<br>æ¾†æ°´: 05:30 å·²å®Œæˆ', animal: '', 
          img: 'https://images.unsplash.com/photo-1500937386664-56d1dfef3854?auto=format&fit=crop&w=800' }
    ];

    // ç”Ÿæˆåœ°åœ–é»ä½èˆ‡æ¨™ç±¤
    bases.forEach(b => {
        const marker = L.marker([b.lat, b.lng], {
            icon: L.divIcon({ className: '', html: '<div class="glow-dot"></div>', iconAnchor: [7, 7] })
        }).addTo(map);

        const label = L.marker([b.lat, b.lng], {
            icon: L.divIcon({ className: 'clean-label', html: b.name, iconAnchor: [-18, 12] })
        }).addTo(map);

        marker.on('click', () => showBase(b.name + "åŸºåœ°", b.img, b.temp, b.plant, b.animal));
    });

    // å½ˆçª—é¡¯ç¤ºé‚è¼¯ï¼šå®Œå…¨é‚„åŸåŸæœ¬çš„éš±è—/é¡¯ç¤ºé‚è¼¯èˆ‡å…©åˆ—ä½ˆå±€èª¿æ•´
    function showBase(name, img, temp, plant, animal) {
        document.getElementById('b-name').innerText = name;
        document.getElementById('b-img').src = img;
        document.getElementById('b-temp').innerText = temp;
        
        const plantBox = document.getElementById('stat-plant');
        const animalBox = document.getElementById('stat-animal');

        if (!plant || plant.trim() === "") {
            plantBox.style.display = 'none';
        } else {
            plantBox.style.display = 'block';
            document.getElementById('b-plant').innerHTML = plant;
        }

        if (!animal || animal.trim() === "") {
            animalBox.style.display = 'none';
        } else {
            animalBox.style.display = 'block';
            document.getElementById('b-animal').innerHTML = animal;
        }

        if (plantBox.style.display === 'none' || animalBox.style.display === 'none') {
            if (plantBox.style.display !== 'none') plantBox.style.gridColumn = 'span 2';
            if (animalBox.style.display !== 'none') animalBox.style.gridColumn = 'span 2';
        } else {
            plantBox.style.gridColumn = 'span 1';
            animalBox.style.gridColumn = 'span 1';
        }

        document.getElementById('base-detail').style.display = 'flex';
    }

    function hideBase() { document.getElementById('base-detail').style.display = 'none'; }
</script>
</body>
</html>